# ğŸ” PHP API Proxy ë³´ì•ˆ ì„¤ì •
# php_api_proxy í´ë” ì „ìš© .htaccess

# ===========================================
# ë³´ì•ˆ ì„¤ì • - ë¯¼ê°í•œ íŒŒì¼ ì ‘ê·¼ ì°¨ë‹¨
# ===========================================

# í™˜ê²½ ë³€ìˆ˜ íŒŒì¼ ì ‘ê·¼ ì°¨ë‹¨
<Files "config.php">
    Order Allow,Deny
    Deny from all
</Files>

<Files ".env*">
    Order Allow,Deny
    Deny from all
</Files>

<Files "load-env.php">
    Order Allow,Deny
    Deny from all
</Files>

# API ë¡œê·¸ íŒŒì¼ ì ‘ê·¼ ì°¨ë‹¨
<Files "api_logs.txt">
    Order Allow,Deny
    Deny from all
</Files>

<Files "rate_limit.json">
    Order Allow,Deny
    Deny from all
</Files>

# ì„œë²„ ì„¤ì • ê°€ì´ë“œ ì ‘ê·¼ ì°¨ë‹¨
<Files "SERVER_ENV_SETUP.txt">
    Order Allow,Deny
    Deny from all
</Files>

<Files "env-example.txt">
    Order Allow,Deny
    Deny from all
</Files>

# ë””ë ‰í† ë¦¬ ë¸Œë¼ìš°ì§• ë¹„í™œì„±í™”
Options -Indexes

# ===========================================
# PHP ì„¤ì •
# ===========================================

# PHP ì—ëŸ¬ ë¡œê·¸ í™œì„±í™”
php_flag log_errors on
php_value error_log "api_logs.txt"

# ìš”ì²­ í¬ê¸° ì œí•œ (10MB)
LimitRequestBody 10485760

# íƒ€ì„ì•„ì›ƒ ì„¤ì •
php_value max_execution_time 60
php_value max_input_time 60
php_value memory_limit 256M

# ì—…ë¡œë“œ í¬ê¸° ì œí•œ
php_value upload_max_filesize 10M
php_value post_max_size 10M

# ===========================================
# CORS ì„¤ì • (ê°œë°œ í™˜ê²½ í¬í•¨)
# ===========================================

<IfModule mod_headers.c>
    # CORSëŠ” PHP íŒŒì¼ì—ì„œ ë™ì ìœ¼ë¡œ ì²˜ë¦¬ë¨
    # ì—¬ê¸°ì„œëŠ” ì¶”ê°€ ë³´ì•ˆ í—¤ë”ë§Œ ì„¤ì •
    
    # XSS ë³´í˜¸
    Header always set X-XSS-Protection "1; mode=block"
    
    # í´ë¦­ì¬í‚¹ ë°©ì§€
    Header always set X-Frame-Options "DENY"
    
    # MIME íƒ€ì… ìŠ¤ë‹ˆí•‘ ë°©ì§€
    Header always set X-Content-Type-Options "nosniff"
    
    # HTTPS ê°•ì œ (ì„ íƒì‚¬í•­)
    # Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains"
</IfModule>

# ===========================================
# OPTIONS ìš”ì²­ ì²˜ë¦¬ (CORS Preflight)
# ===========================================

RewriteEngine On
RewriteCond %{REQUEST_METHOD} OPTIONS
RewriteRule ^(.*)$ $1 [R=200,L]

